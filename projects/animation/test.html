<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mouse-Controlled Image Rotation</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        overflow-x: hidden;
      }

      .container {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        max-width: 1200px;
        width: 100%;
      }

      h1 {
        text-align: center;
        color: #333;
        margin-bottom: 30px;
        font-size: 2.5rem;
        background: linear-gradient(45deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        align-items: center;
        justify-content: center;
        margin-bottom: 30px;
        padding: 20px;
        background: rgba(103, 126, 234, 0.1);
        border-radius: 15px;
        border: 1px solid rgba(103, 126, 234, 0.2);
      }

      .control-group {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
      }

      .slider {
        width: 150px;
        height: 8px;
        border-radius: 5px;
        background: rgba(103, 126, 234, 0.2);
        outline: none;
        -webkit-appearance: none;
        appearance: none;
      }

      .slider::-webkit-slider-thumb {
        appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: linear-gradient(45deg, #667eea, #764ba2);
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
      }

      .slider::-webkit-slider-thumb:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
      }

      .slider::-moz-range-thumb {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: linear-gradient(45deg, #667eea, #764ba2);
        cursor: pointer;
        border: none;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .control-label {
        font-weight: 600;
        color: #333;
        text-align: center;
        font-size: 0.9rem;
      }

      .value-display {
        background: rgba(103, 126, 234, 0.1);
        padding: 4px 8px;
        border-radius: 8px;
        font-weight: bold;
        color: #667eea;
      }

      .viewer-container {
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 500px;
        background: rgba(0, 0, 0, 0.05);
        border-radius: 15px;
        overflow: hidden;
        border: 2px dashed rgba(103, 126, 234, 0.3);
        cursor: grab;
        user-select: none;
      }

      .viewer-container:active {
        cursor: grabbing;
      }

      .image-viewer {
        position: relative;
        max-width: 100%;
        max-height: 80vh;
      }

      .rotating-image {
        max-width: 100%;
        max-height: 80vh;
        object-fit: contain;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        transition: opacity 0.3s ease;
      }

      .placeholder {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: #666;
        font-size: 1.2rem;
        gap: 15px;
        text-align: center;
      }

      .placeholder-icon {
        font-size: 3rem;
        opacity: 0.5;
      }

      .status-bar {
        margin-top: 20px;
        padding: 15px;
        background: rgba(103, 126, 234, 0.1);
        border-radius: 15px;
        border: 1px solid rgba(103, 126, 234, 0.2);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
      }

      .status-item {
        display: flex;
        align-items: center;
        gap: 5px;
        color: #333;
        font-weight: 500;
      }

      .indicator {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #ccc;
        transition: all 0.3s ease;
      }

      .indicator.active {
        background: #4caf50;
        box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
      }

      .tips {
        margin-top: 20px;
        padding: 20px;
        background: rgba(103, 126, 234, 0.1);
        border-radius: 15px;
        border: 1px solid rgba(103, 126, 234, 0.2);
      }

      .tips h3 {
        color: #333;
        margin-bottom: 10px;
      }

      .tips ul {
        color: #666;
        padding-left: 20px;
      }

      .tips li {
        margin-bottom: 5px;
      }

      .loading {
        opacity: 0.5;
        pointer-events: none;
      }

      .frame-counter {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 0.8rem;
        font-weight: bold;
      }

      @media (max-width: 768px) {
        .controls {
          flex-direction: column;
        }

        .slider {
          width: 120px;
        }

        h1 {
          font-size: 2rem;
        }

        .status-bar {
          flex-direction: column;
          text-align: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="controls">
        <div class="control-group">
          <input
            type="range"
            id="sensitivitySlider"
            class="slider"
            min="0.1"
            max="3"
            step="0.1"
            value="1"
          />
        </div>

        <div class="control-group">
          <input
            type="range"
            id="smoothingSlider"
            class="slider"
            min="1"
            max="20"
            value="5"
          />
        </div>
      </div>

      <div class="viewer-container" id="viewerContainer">
        <div class="placeholder">
          <div class="placeholder-icon">üñºÔ∏è</div>
          <div>Loading animation sequence...</div>
          <small>Move your mouse left/right to rotate through frames</small>
        </div>
      </div>

      <div class="status-bar">
        <div class="status-item">
          <div class="indicator" id="imagesIndicator"></div>
          <span id="imageCount">0 images loaded</span>
        </div>
        <div class="status-item">
          <div class="indicator" id="mouseIndicator"></div>
          <span>Mouse tracking</span>
        </div>
        <div class="status-item">
          <span
            >Frame: <span id="currentFrame">0</span>/<span id="totalFrames"
              >0</span
            ></span
          >
        </div>
      </div>
    </div>

    <script>
      let images = [];
      let currentImageIndex = 0;
      let mouseX = 0;
      let lastMouseX = 0;
      let sensitivity = 1;
      let smoothing = 5;
      let isMouseInViewer = false;
      let frameBuffer = [];

      const sensitivitySlider = document.getElementById("sensitivitySlider");
      const smoothingSlider = document.getElementById("smoothingSlider");
      const sensitivityValue = document.getElementById("sensitivityValue");
      const smoothingValue = document.getElementById("smoothingValue");
      const viewerContainer = document.getElementById("viewerContainer");
      const imagesIndicator = document.getElementById("imagesIndicator");
      const mouseIndicator = document.getElementById("mouseIndicator");
      const imageCount = document.getElementById("imageCount");
      const currentFrame = document.getElementById("currentFrame");
      const totalFrames = document.getElementById("totalFrames");

      // Handle slider changes
      sensitivitySlider.addEventListener("input", (e) => {
        sensitivity = parseFloat(e.target.value);
        sensitivityValue.textContent = `${sensitivity.toFixed(1)}x`;
      });

      smoothingSlider.addEventListener("input", (e) => {
        smoothing = parseInt(e.target.value);
        smoothingValue.textContent = smoothing;
      });

      // Mouse tracking
      viewerContainer.addEventListener("mouseenter", () => {
        isMouseInViewer = true;
        mouseIndicator.classList.add("active");
      });

      viewerContainer.addEventListener("mouseleave", () => {
        isMouseInViewer = false;
        mouseIndicator.classList.remove("active");
      });

      viewerContainer.addEventListener("mousemove", (e) => {
        if (!isMouseInViewer || images.length === 0) return;

        const rect = viewerContainer.getBoundingClientRect();
        const relativeX = (e.clientX - rect.left) / rect.width;

        // Calculate target frame based on mouse position
        const targetFrame = Math.floor(relativeX * images.length);
        const clampedFrame = Math.max(
          0,
          Math.min(images.length - 1, targetFrame)
        );

        // Apply smoothing
        frameBuffer.push(clampedFrame);
        if (frameBuffer.length > smoothing) {
          frameBuffer.shift();
        }

        // Calculate average frame
        const avgFrame = Math.round(
          frameBuffer.reduce((a, b) => a + b, 0) / frameBuffer.length
        );

        if (avgFrame !== currentImageIndex) {
          currentImageIndex = avgFrame;
          updateDisplay();
        }
      });

      function updateViewer() {
        if (images.length === 0) return;

        viewerContainer.innerHTML = "";

        const imageViewer = document.createElement("div");
        imageViewer.className = "image-viewer";

        const img = document.createElement("img");
        img.src = images[currentImageIndex].src;
        img.className = "rotating-image";
        img.alt = `Frame ${currentImageIndex + 1}`;

        const frameCounter = document.createElement("div");
        frameCounter.className = "frame-counter";
        frameCounter.textContent = `${currentImageIndex + 1}/${images.length}`;

        imageViewer.appendChild(img);
        imageViewer.appendChild(frameCounter);
        viewerContainer.appendChild(imageViewer);
      }

      function updateDisplay() {
        if (images.length === 0) return;

        const img = viewerContainer.querySelector(".rotating-image");
        const counter = viewerContainer.querySelector(".frame-counter");

        if (img && images[currentImageIndex]) {
          img.src = images[currentImageIndex].src;
          img.alt = `Frame ${currentImageIndex + 1}`;
        }

        if (counter) {
          counter.textContent = `${currentImageIndex + 1}/${images.length}`;
        }

        currentFrame.textContent = currentImageIndex + 1;
      }

      function updateStatus() {
        imageCount.textContent = `${images.length} images loaded`;
        totalFrames.textContent = images.length;
        currentFrame.textContent =
          images.length > 0 ? currentImageIndex + 1 : 0;

        if (images.length > 0) {
          imagesIndicator.classList.add("active");
        } else {
          imagesIndicator.classList.remove("active");
        }
      }

      // Auto-load images from folder on page load
      function autoLoadImages() {
        const basePath =
          "../../assets/animation/2025-11-01-bg-cosmo-pink-mini/";
        const imagePromises = [];

        // Generate image paths from _2025-11-01_06 to _2025-11-01_32
        for (let i = 1; i <= 32; i++) {
          const paddedNumber = String(i).padStart(3, "0");
          const imagePath = `${basePath}_2025-11-01_${paddedNumber}-small.jpeg`;

          const promise = new Promise((resolve, reject) => {
            const img = new Image();
            img.onload = () => resolve(img);
            img.onerror = () => {
              console.warn(`Failed to load: ${imagePath}`);
              resolve(null);
            };
            img.src = imagePath;
          });

          imagePromises.push(promise);
        }

        viewerContainer.classList.add("loading");

        Promise.all(imagePromises).then((loadedImages) => {
          // Filter out any failed images
          images = loadedImages.filter((img) => img !== null);

          if (images.length > 0) {
            currentImageIndex = 0;
            frameBuffer = [];
            updateViewer();
            updateStatus();
            viewerContainer.classList.remove("loading");
          } else {
            viewerContainer.classList.remove("loading");
            console.error(
              "No images could be loaded from the specified folder"
            );
          }
        });
      }

      // Initialize and auto-load images
      updateStatus();
      autoLoadImages();
    </script>
  </body>
</html>
